# Discover 运营手册（给运营同学）

> 目标：让更多用户在 Discover 里“看见 → 想下 → 直接下载 → 登录/付费”，同时把内容维护成本降到最低（优先 oEmbed，爬取补充；允许降级兜底）。

## 1. 我们在运营什么（业务目标 & 指标）

**核心漏斗**
- Discover 曝光（PV/UV）→ 下载点击（`download_click`）→ 下载完成/成功（以下载链路实际结果为准）→ 登录 → 购买点数/付费

**建议盯的指标（按优先级）**
- Discover 页面：UV、视频卡片点击率（CTR）、人均下载点击数（`download_click / UV`）
- 下载链路：下载成功率、下载失败 Top 原因（平台/链接类型）
- 转化：下载点击 → 登录率、登录 → 购买率、购买后复购（7d/30d）
- 供给侧：白名单创作者数量、同步成功率、同步失败率、有效内容量（可下载且 `is_active=true`）

## 2. Discover 页面结构（系统如何配合）

Discover 目前展示 4 个区块（仅优先 TikTok / Instagram）：

1) **热榜（Trending）**
- **来源**：站内行为自动统计，按最近 7 天的 `download_click` 聚合排序（分平台可筛选）。
- **运营能做什么**：通过首页曝光、社媒引流、精选位加推等方式提升优质内容点击，系统会自动把高点击内容顶上来。

2) **置顶（Pinned）**
- **来源**：白名单创作者同步时自动抓取置顶/近况（IG 能识别置顶；TikTok 当前为“近似置顶”兜底）。
- **运营能做什么**：选择值得长期展示的创作者加入白名单并开启自动同步；置顶抓不到时用“精选（Featured）”兜底。

3) **精选（Featured）**
- **来源**：管理员在后台对单条视频手动设置精选（当前后台支持勾选精选；如需自定义顺序请联系研发/管理员用 API 调整 `display_order`）。
- **运营能做什么**：把转化最好/质量最高/适合新用户理解产品价值的视频放进精选，作为“编辑推荐位”。

4) **最新（Latest）**
- **来源**：按入库时间倒序展示（分页加载）。
- **运营能做什么**：保证白名单同步稳定、新内容持续入库；必要时补充人工上新。

另外：每条视频卡片的「More from creator」会拉取该创作者的置顶 + 最近内容，支持批量下载，提高单次会话深度。

## 3. 内容供给：白名单创作者（优先策略）

### 3.1 什么时候该加白名单
- 该创作者内容质量稳定、受众明确、下载意图强（教程/素材/穿搭/舞蹈拆解等）
- 能带来持续流量（账号更新频率高 / 有固定粉丝盘）
- 适合做“系列化内容”，能推动「More from creator」批量下载

### 3.2 如何添加白名单创作者（后台 SOP）

入口：`/<lang>/console-manage-2025/accounts`

步骤：
1. 点击「+ 添加账号」
2. 选择平台：TikTok / Instagram
3. 填写 `username`（建议只填纯用户名，不要带 @ 或 URL）
4. 勾选「自动同步（最近 5 条 + 置顶）」
5. 保存后，点击列表里的「同步」按钮（循环箭头图标）进行 **Sync now**（立即拉取内容）
6. 观察同步状态：
   - 成功：会提示新增/更新数量
   - 失败：账号卡片会显示「同步失败」，可在 hover 里看到错误详情（`sync_error`）

> 注意：系统不使用付费第三方 API。优先走免费 oEmbed；当 oEmbed 不可用/不稳定时，会用爬取做补充；仍失败则需要运营兜底（见 5.2）。

### 3.3 白名单同步策略（系统行为）
- 默认会拉取：**最近 5 条** + **置顶视频**（或兜底近似置顶）
- 同步写入后会进入 Discover 的「置顶 / 最新」区块；优秀内容可再被运营手动放进「精选」

## 4. 内容运营：精选位（Featured）怎么用

**精选位的定位**
- 用来展示“最能说明产品价值”的内容：一键下载、批量下载、下载质量、速度等
- 用来做新用户转化：优先挑“高下载意图”内容（素材/教程/合集/可复用片段）

**如何设置/取消精选（后台操作）**
- 入口：`/<lang>/console-manage-2025/videos`
- 找到目标视频（可用平台/作者筛选）
- 点击星标按钮，或编辑时勾选「设为精选视频」
- 保存后刷新 Discover 即可生效

**建议节奏**
- 每天至少维护 1 次（早高峰前）：把热榜里表现好的内容提到精选
- 每周做一次“精选清理”：移除过期/失效/质量下降内容，保持精选位稳定

## 5. 日常运营 SOP（建议照着做）

### 5.1 每日（10–20 分钟）
- 查看 Discover「热榜」：挑 3–5 条最值得转化的内容，加入精选
- 查看白名单账号同步状态：
  - 对重点创作者点「Sync now」（循环箭头图标）
  - 有错误的账号记录原因，必要时临时关闭自动同步（避免反复失败）
- 抽查随机 5 条：能否正常下载、封面是否可见、链接是否失效

### 5.2 降级兜底（当自动化失灵时怎么做）
- **置顶抓不到**：用精选位替代（把对应视频手动精选）
- **同步失败**：
  1) 先重试 Sync now
  2) 仍失败：取消「自动同步」，改人工维护（少量关键账号优先）
  3) 记录失败类型（403/频控/页面结构变化），反馈给研发
- **人工补内容**（少量兜底用）：在 `/<lang>/console-manage-2025/videos` 手动新增视频 URL，并可勾选精选

### 5.3 每周（30–60 分钟）
- 复盘：热榜→下载→付费漏斗的变化（按平台拆分）
- 内容结构优化：精选位是否覆盖“新手必看/高意图/多场景”
- 白名单迭代：新增高价值作者、淘汰长期无贡献作者（或先停用）

## 6. 常见问题（FAQ）

### Q1：视频怎么上热榜？是运营手动设置的吗？
- 不是手动。系统会统计用户在 Discover 的下载点击（`download_click`），按最近 7 天累计次数排序；只有 `is_active=true` 且有点击数据的视频才会出现在热榜。
- 运营影响方式：用精选位/入口曝光/活动引流提升点击，热榜会自动更新。

### Q2：热榜为什么是空的？
- 只有当用户在 Discover 里产生下载点击（`download_click`）后才会有数据；冷启动期依赖精选/置顶做内容门面。

### Q3：TikTok/Instagram 的置顶是否一定能抓到？
- Instagram 置顶识别更可靠；TikTok 目前为“可用的免费兜底方案”，可能会把前几条近似当置顶。抓不到时用精选兜底。

### Q4：为什么运营不建议大量人工导入？
- 人工导入成本高、更新慢；系统设计就是“白名单自动化 + 热榜自动化”为主，人工只做高价值干预（精选位/关键作者兜底）。

### Q5：为什么 Discover 的封面过一段时间会显示不了？
- 封面 `thumbnail_url` 多数来自 TikTok/Instagram 的 CDN 签名临时链接，会带过期参数（例如 TikTok 的 `x-expires`、Instagram 的 `oe`），到期后图片会 403/404。
- 解决方式：
  1) 运营侧：后台对关键创作者点一次「Sync now」可立即刷新封面；
  2) 系统侧：对已开启「自动同步」的白名单账号配置定时任务，周期性跑 `pnpm -C api social:sync-enabled`（建议 12–24 小时一次），让封面长期可用。
- 排查/验证：用 `pnpm -C api social:thumb-expiry` 可以统计当前库里封面 URL 的 TTL 与是否已过期。

## 7. 需要研发配合时，你该怎么提需求

为了更快落地，建议按下面模板提：
- **目标指标**：要提升哪个指标（CTR / 下载点击 / 付费率 / 留存）
- **改动位置**：Discover 热榜 / 精选位 / 白名单同步 / 投稿机制
- **验收方式**：上线后看哪个看板、用什么口径、观察多久
- **降级方案**：失败时是否允许回退到“精选兜底/人工维护”
